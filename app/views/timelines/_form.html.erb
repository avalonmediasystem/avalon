<div id="timeline_edit_div" class="container">
  <%= form_for(@timeline, html: { id: 'timeline_form', class: 'form-horizontal timeline_actions' }) do |f| %>
  <div class="row form-group <% if @timeline.errors[:title].any? %>has-error<% end %>">
    <%= f.label "Name", class: 'col-sm-2 control-label' %>
    <div class="col-sm-10"><%= f.text_field :title, class: 'form-control' %></div>
  </div>
  <div class="row form-group">
    <%= f.label :description, 'Description', class: 'col-sm-2 control-label' %>
    <div class="col-sm-10"><%= f.text_area :description, class: 'form-control', rows: '4' %></div>
  </div>
  <div class="row form-group">
    <%= label_tag nil, t("timeline.visibility"), class: 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <label class="radio-inline">
        <%= f.radio_button(:visibility, Timeline::PUBLIC) %>
        <%= timeline_human_friendly_visibility Timeline::PUBLIC %>
      </label>
      <label class="radio-inline">
        <%= f.radio_button(:visibility, Timeline::PRIVATE) %>
        <%= timeline_human_friendly_visibility Timeline::PRIVATE %>
      </label>
      <label class="radio-inline">
        <%= f.radio_button(:visibility, Timeline::PRIVATE_WITH_TOKEN, class: 'share-timeline') %>
        <%= timeline_human_friendly_visibility Timeline::PRIVATE_WITH_TOKEN %>
      </label>
      <p class="text-info visibility-help-text" style="padding-top:5px;font-style:italic;">
        <%= timeline_visibility_description @timeline.visibility %>
      </p>
      <div id="timeline_token_row" class="row container collapse <%= 'in' if @timeline.visibility=='private-with-token' %>" style="margin-top:9px;">
        <div class="col-xs-9">
          <div class="input-group">
            <input type="text" class="form-control" id="timeline-share-link" value="<%= access_token_url(@timeline) %>" placeholder="<%= access_token_url(@timeline) %>" onClick="this.select();" readonly="readonly">
            <span class="input-group-btn" id="timeline-share-btn-result">
              <%= button_tag "Copy", id: 'timeline-share-btn', class: "btn btn-success", form: 'timeline_new_link_form' %>
            </span>
          </div>
        </div>
        <div class="col-xs-2">
          <%= button_tag "Get new link", id: 'get-new-link', form: 'timeline_new_link_form',
            class: 'btn btn-success', data: { 'timeline_id': @timeline.id } %>
        </div>
      </div>
    </div>
  </div>
  <% if Avalon::Authentication.lti_configured? %>
    <div id="timeline_lti_share" class="row form-group collapse <%= 'in' if @timeline.visibility != 'private' %>">
      <%= label_tag nil, 'LTI URL', class: 'col-sm-2 control-label' %>

      <div class="col-sm-10">
        <p class="text-info" style="padding-top:5px;font-style:italic;">
          Copy the link below to share this timeline via LTI
        </p>
        <div class="row container" style="margin-top:9px;">
          <div class="col-xs-9">
            <div class="input-group">
              <input type="text" class="form-control" id="timeline-lti-share-link" value="<%= lti_share_url_for(@timeline) %>" placeholder="<%= lti_share_url_for(@timeline) %>" onClick="this.select();" readonly="readonly">
              <span class="input-group-btn" id="timeline-lti-share-btn-result">
                <%= button_tag "Copy", id: 'timeline-lti-share-btn', class: "btn btn-success", form: 'timeline_new_link_form' %>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <div class="row form-group">
    <%= label_tag nil, t("timeline.tags.label"), class: 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <%= render partial:'tag_form' %>
    </div>
  </div>
  <div class="row form-group">
    <%= label_tag nil, t("timeline.source_link"), class: 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <div style="padding: 7px 0 7px 0">
        <a href=<%= @timeline.source %>><%= @timeline.source %></a>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-offset-2 col-sm-10">
      <div>
        <%= f.submit id: 'submit-timeline-form', class: 'btn btn-primary btn-xs', value: t("timeline.#{params[:action]}.action") %>
      </div>
    </div>
  </div>
  <% end # form_for timeline_form%>
</div>
