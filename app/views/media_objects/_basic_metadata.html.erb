<% if flash[:error] %><div class='alert alert-error'><%= flash[:error] %></div><% end %>

<%= twitter_bootstrap_form_for @mediaobject, html: { class: 'form-vertical', id: 'basic_metadata_form' } do |vid| %>
  <%= hidden_field_tag :step, @active_step %>
  <%= vid.fieldset 'Required fields', id: 'required_fields' do %>
    <%= vid.text_field :title, 'Title', class: 'span8' %>
    <%= vid.text_field :creator, 'Creator', class: 'span8' %>
    <%= vid.text_field :date_created, 'Creation date', class: 'span8' %>
    <%= vid.text_area :abstract, 'Summary', class: 'span8', rows: 6 %>
  <% end %>

  <%= vid.fieldset 'Dates and places', id: 'dates_and_places' do %>
    <%= vid.text_field :date_issued, 'Issue date', class: 'span8' %>
    <%= vid.text_field :copyright_date, 'Copyright date', class: 'span8' %>
    
    <%= link_to_add_dynamic_field('Add Field') %>
    <%= vid.text_fields :temporal_subject, 'Time periods', class: 'span8 dynamic_field', mininum_fields: 2, value: @mediaobject.temporal_subject %>
    
    <%= link_to_add_dynamic_field('Add Field') %>
    <%= vid.text_fields :geographic_subject, 'Locations', class: 'span8 dynamic_field', minimum_fields: 2, value: @mediaobject.geographic_subject %>
  <% end %>
  
  <%= vid.fieldset 'Related people', id: 'related_people' do %>

    <%= link_to_add_dynamic_field('Add Field') %>
    <%= vid.text_fields :contributor, 'Contributor(s)', class: 'span8 dynamic_field', value: @mediaobject.contributor %>

    <%= link_to_add_dynamic_field('Add Field') %>
    <%= vid.text_fields :publisher, 'Publisher(s)', class: 'span8 dynamic_field', minimum_fields: 3, value: @mediaobject.publisher %>
  <% end %>
  
  <%= vid.fieldset 'Keyword(s)', id: 'keywords' do %>    
    <%= vid.text_field :genre, 'Genre', class: 'span8' %>
    
    <%= link_to_add_dynamic_field('Add Field') %>
    <%= vid.text_fields :topical_subject, 'Subject(s)', class: 'span8 dynamic_field', value: @mediaobject.topical_subject %>
  <% end %>

  <%= vid.fieldset 'Collections', id: 'collection_info' do %>
    <%= link_to_add_dynamic_field('Add Field') %>
    <%= vid.text_fields :collection, 'Collection(s)', class: 'span8 dynamic_field', minimum_fields: 3, value: @mediaobject.collection %>
  <% end %>

  <%= vid.actions do |actions| %>
      <%= render 'workflow_buttons', form: vid %>
  <% end %>
<% end %>

<%= javascript_tag do %>

  window.onload = function(){
    DynamicFields.initialize();
  }

<% end %>

